Sub CheckFormatH()

Application.ScreenUpdating = False

On Error GoTo errorHandler

Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, Formula1:="=0"
Selection.FormatConditions(1).Interior.Color = RGB(198, 239, 206)
Selection.FormatConditions(1).Font.Color = RGB(0, 97, 0)
'Add second rule
Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlNotEqual, Formula1:="=0"
Selection.FormatConditions(2).Interior.Color = RGB(255, 199, 206)
Selection.FormatConditions(2).Font.Color = RGB(156, 0, 0)

Selection.HorizontalAlignment = xlCenter
Exit Sub

errorHandler:
errorHandler.Show

End Sub
Sub reun(Optional CellRange As Range)
    If CellRange Is Nothing Then Set CellRange = Selection
    If CellRange Is Nothing Or CellRange.Cells.Count = 0 Then Exit Sub
    If CellRange.Areas.Count > 1 Then
        MsgBox "The macro only works on continuous ranges.", vbExclamation
        Exit Sub
    End If

    With CellRange
        .Interior.Color = RGB(220, 230, 243)
        .Font.Bold = True
        .Font.Color = RGB(14, 26, 44)
        .RowHeight = 14.5
    End With

    CellRange.Cells(1, 1).HorizontalAlignment = xlLeft

    If CellRange.Cells.Count > 1 And CellRange.Columns.Count > 1 Then
        CellRange.Offset(0, 1).Resize(CellRange.Rows.Count, CellRange.Columns.Count - 1).HorizontalAlignment = xlRight
    End If
End Sub

' Summary: Style the row 2 header band with medium blue and contrasting text.
' Used by: FormatFullSheet, FormatSmartSheet.
Sub rdeux(Optional CellRange As Range)
    If CellRange Is Nothing Then Set CellRange = Selection
    If CellRange Is Nothing Or CellRange.Cells.Count = 0 Then Exit Sub
    If CellRange.Areas.Count > 1 Then
        MsgBox "The macro only works on continuous ranges.", vbExclamation
        Exit Sub
    End If

    With CellRange
        .Interior.Color = RGB(62, 140, 255)
        .Font.Bold = True
        .Font.Color = RGB(255, 255, 255)
        .RowHeight = 14.5
    End With

    CellRange.Cells(1, 1).HorizontalAlignment = xlLeft

    If CellRange.Cells.Count > 1 And CellRange.Columns.Count > 1 Then
        CellRange.Offset(0, 1).Resize(CellRange.Rows.Count, CellRange.Columns.Count - 1).HorizontalAlignment = xlRight
    End If
End Sub

' Summary: Style the row 3 header band with dark blue fill for totals.
' Used by: FormatFullSheet, FormatSmartSheet.
Sub rtrois(Optional CellRange As Range)
    If CellRange Is Nothing Then Set CellRange = Selection
    If CellRange Is Nothing Or CellRange.Cells.Count = 0 Then Exit Sub
    If CellRange.Areas.Count > 1 Then
        MsgBox "The macro only works on continuous ranges.", vbExclamation
        Exit Sub
    End If

    With CellRange
        .Interior.Color = RGB(24, 46, 78)
        .Font.Bold = True
        .Font.Color = RGB(255, 255, 255)
        .RowHeight = 14.5
    End With

    CellRange.Cells(1, 1).HorizontalAlignment = xlLeft

    If CellRange.Cells.Count > 1 And CellRange.Columns.Count > 1 Then
        CellRange.Offset(0, 1).Resize(CellRange.Rows.Count, CellRange.Columns.Count - 1).HorizontalAlignment = xlRight
    End If
End Sub
Public Sub NoDecimals(Optional CellRange As Range = Nothing)
    If CellRange Is Nothing Then Set CellRange = Selection
    CellRange.NumberFormat = "#,##0_);(#,##0);""-""_)"
End Sub
' Summary: Apply width presets based on parameter sheet sizing categories.
' Used by: AdjustColumnWidths, FormatMinimalSheet.
Sub ACW(Optional TargetColumns As Range = Nothing, Optional SizeCategory As Integer = 2)
    Dim col As Range
    Dim FixedWidth As Double
    Dim ws As Worksheet
    Set ws = ActiveWorkbook.Sheets("8A_Team_ParametersNYC")

    If TargetColumns Is Nothing Then Set TargetColumns = Selection

    Select Case SizeCategory
        Case 1: FixedWidth = ws.Range("C7").Value
        Case 2: FixedWidth = ws.Range("C6").Value
        Case 3: FixedWidth = 35.14
        Case Else: FixedWidth = 10
    End Select

    For Each col In TargetColumns.Columns
        col.ColumnWidth = FixedWidth
    Next col
End Sub

Sub ARH(Optional TargetRows As Range = Nothing, Optional SizeCategory As Integer = 2)
    Dim row As Range
    Dim FixedHeight As Double
    Dim ws As Worksheet
    Set ws = ActiveWorkbook.Sheets("8A_Team_ParametersNYC") ' Feuille où se trouve la valeur de référence

    ' Si aucun TargetRows n'est spécifié, utiliser la sélection actuelle
    If TargetRows Is Nothing Then Set TargetRows = Selection

    ' Définir la hauteur en fonction de la catégorie
    Select Case SizeCategory
        Case 1: FixedHeight = ws.Range("C5").Value ' Petit
        Case 2: FixedHeight = ws.Range("C8").Value ' Moyen
        Case 3: FixedHeight = 25 ' Grand
        Case Else: FixedHeight = 10 ' Défaut à moyen si valeur incorrecte
    End Select

    ' Appliquer la hauteur aux lignes
    For Each row In TargetRows.Rows
        row.RowHeight = FixedHeight
    Next row
End Sub
